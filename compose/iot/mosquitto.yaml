# Mosquitto is used as my local MQTT broker
secrets:
  mosquitto_broker:
    file: $DOCKER_SECRETS_DIR/mosquitto_broker

services:
  mosquitto:
    container_name: mosquitto
    image: eclipse-mosquitto:latest
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    volumes:
      - $DOCKER_CONFIG_DIR/mosquitto:/mosquitto/config:ro
      - $DOCKER_DATA_DIR/mosquitto/data:/mosquitto/data:rw
      - $DOCKER_DATA_DIR/mosquitto/log:/mosquitto/log:rw
    secrets:
      - mosquitto_broker
    networks:
      traefik-proxy:
        ipv4_address: 172.18.0.100
    ports:
      - 1883:1883